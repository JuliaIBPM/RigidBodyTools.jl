<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Deforming bodies · RigidBodyTools.jl</title><meta name="title" content="Deforming bodies · RigidBodyTools.jl"/><meta property="og:title" content="Deforming bodies · RigidBodyTools.jl"/><meta property="twitter:title" content="Deforming bodies · RigidBodyTools.jl"/><meta name="description" content="Documentation for RigidBodyTools.jl."/><meta property="og:description" content="Documentation for RigidBodyTools.jl."/><meta property="twitter:description" content="Documentation for RigidBodyTools.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">RigidBodyTools.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Bodies and Transforms</span><ul><li><a class="tocitem" href="../shapes/">Creating bodies</a></li><li><a class="tocitem" href="../transforms/">Plucker vectors and coordinate transforms</a></li><li><a class="tocitem" href="../bodylists/">Lists of bodies and their transforms</a></li></ul></li><li><span class="tocitem">Motions</span><ul><li><a class="tocitem" href="../dofmotions/">Behaviors of degrees of freedom</a></li><li><a class="tocitem" href="../joints/">Joints and body-joint systems</a></li><li><a class="tocitem" href="../exogenous/">Exogenous degrees of freedom</a></li><li class="is-active"><a class="tocitem" href>Deforming bodies</a><ul class="internal"><li><a class="tocitem" href="#Example:-Basic-deformation"><span>Example: Basic deformation</span></a></li><li><a class="tocitem" href="#Example:-Expanding-motion"><span>Example: Expanding motion</span></a></li><li><a class="tocitem" href="#Example:-Combining-rigid-motion-and-deforming-motion."><span>Example: Combining rigid motion and deforming motion.</span></a></li><li><a class="tocitem" href="#Example:-Defining-new-deformations"><span>Example: Defining new deformations</span></a></li><li><a class="tocitem" href="#Deformation-functions"><span>Deformation functions</span></a></li></ul></li><li><a class="tocitem" href="../surfacevelocities/">Evaluating velocities on body surfaces</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Motions</a></li><li class="is-active"><a href>Deforming bodies</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Deforming bodies</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaIBPM/RigidBodyTools.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaIBPM/RigidBodyTools.jl/blob/master/test/literate/deformation.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Deforming-bodies"><a class="docs-heading-anchor" href="#Deforming-bodies">Deforming bodies</a><a id="Deforming-bodies-1"></a><a class="docs-heading-anchor-permalink" href="#Deforming-bodies" title="Permalink"></a></h1><p>Thus far we have only shown rigid body motion. However, we can also prescribe surface deformation as an additional component of a body&#39;s motion.</p><pre><code class="language-julia hljs">using RigidBodyTools
using Plots</code></pre><p>Before we get started, let&#39;s define the same macro that we used earlier in order to visualize our system&#39;s motion</p><pre><code class="language-julia hljs">macro animate_motion(b,m,dt,tmax,xlim,ylim)
    return esc(quote
            bc = deepcopy($b)
            t0, x0 = 0.0, init_motion_state(bc,$m)
            dxdt = zero(x0)
            x = copy(x0)

            @gif for t in t0:$dt:t0+$tmax
                motion_rhs!(dxdt,x,($m,bc),t)
                global x += dxdt*$dt
                update_body!(bc,x,$m)
                plot(bc,xlims=$xlim,ylims=$ylim)
            end every 5
        end)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">@animate_motion (macro with 1 method)</code></pre><p>For deforming bodies, we specify the velocity of the surface directly. This deformation velocity is expressed in the coordinate system attached to the body, rather than the inertial coordinate system. This enables the motion to be easily superposed with the rigid-body motion described earlier.</p><p>It is also important to note that the motion is applied <strong>to the endpoints</strong> of the surface segments. The midpoints are then constructed from the updated endpoints.</p><h2 id="Example:-Basic-deformation"><a class="docs-heading-anchor" href="#Example:-Basic-deformation">Example: Basic deformation</a><a id="Example:-Basic-deformation-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Basic-deformation" title="Permalink"></a></h2><p>Let&#39;s see an example. We will create an oscillatory deformation of a circle. We create the motion by creating functions for each component of velocity.</p><pre><code class="language-julia hljs">Ω = 2π
ufcn(x,y,t) = 0.25*x*y*Ω*cos(Ω*t)
vfcn(x,y,t) = 0.25*(x^2-y^2)*Ω*cos(Ω*t)
def = DeformationMotion(ufcn,vfcn)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">DeformationMotion{typeof(Main.ufcn), typeof(Main.vfcn)}(Main.ufcn, Main.vfcn)</code></pre><p>We will create a simple fixed revolute joint that anchors the body&#39;s center to the inertial system. (Note that we don&#39;t need to create a body list here, since we are only working with one body and one joint.)</p><pre><code class="language-julia hljs">Xp_to_jp = MotionTransform(0.0,0.0,0.0)
Xc_to_jc = MotionTransform(0.0,0.0,0.0)
dofs = [ConstantVelocityDOF(0.0)]
joint = Joint(RevoluteJoint,0,Xp_to_jp,1,Xc_to_jc,dofs)

body = Circle(1.0,0.02)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Circular body with 312 points and radius 1.0
   Current position: (0.0,0.0)
   Current angle (rad): 0.0
</code></pre><p>To construct the system, we supply the joint and body, as before, as well as the deformation.</p><pre><code class="language-julia hljs">ls = RigidBodyMotion(joint,body,def)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1 linked system(s) of bodies
   1 bodies
   1 joints
</code></pre><p>Let&#39;s animate this motion</p><pre><code class="language-julia hljs">@animate_motion body ls 0.01 4 (-2,2) (-2,2)</code></pre><img src="abfc2df0.gif" alt="Example block output"/><p>The body remains fixed, but the surface deforms!</p><h2 id="Example:-Expanding-motion"><a class="docs-heading-anchor" href="#Example:-Expanding-motion">Example: Expanding motion</a><a id="Example:-Expanding-motion-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Expanding-motion" title="Permalink"></a></h2><p>Now a circle undergoing an expansion. For this, we set constant velocity components equal to constants, the coordinates of the surface segment endpoints</p><pre><code class="language-julia hljs">body = Circle(1.0,0.02)

u = copy(body.x̃end)
v = copy(body.ỹend)
def = ConstantDeformationMotion(u,v)

ls = RigidBodyMotion(joint,body,def)
@animate_motion body ls 0.01 2 (-5,5) (-5,5)</code></pre><img src="155961d1.gif" alt="Example block output"/><h2 id="Example:-Combining-rigid-motion-and-deforming-motion."><a class="docs-heading-anchor" href="#Example:-Combining-rigid-motion-and-deforming-motion.">Example: Combining rigid motion and deforming motion.</a><a id="Example:-Combining-rigid-motion-and-deforming-motion.-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Combining-rigid-motion-and-deforming-motion." title="Permalink"></a></h2><p>Now, let&#39;s combine an oscillatory rigid-body rotation with oscillatory deformation, this time applied to a square.</p><pre><code class="language-julia hljs">Xp_to_jp = MotionTransform(0.0,0.0,0.0)
Xc_to_jc = MotionTransform(0.0,0.0,0.0)
Ω = 1.0
dofs = [OscillatoryDOF(π/4,Ω,0.0,0.0)]
joint = Joint(RevoluteJoint,0,Xp_to_jp,1,Xc_to_jc,dofs)

body = Square(1.0,0.02)

ufcn(x,y,t) = 0.25*(x^2+y^2)*y*Ω*cos(Ω*t)
vfcn(x,y,t) = -0.25*(x^2+y^2)*x*Ω*cos(Ω*t)
def = DeformationMotion(ufcn,vfcn)

ls = RigidBodyMotion(joint,body,def)

@animate_motion body ls π/100 4π (-2,2) (-2,2)</code></pre><img src="61953209.gif" alt="Example block output"/><h2 id="Example:-Defining-new-deformations"><a class="docs-heading-anchor" href="#Example:-Defining-new-deformations">Example: Defining new deformations</a><a id="Example:-Defining-new-deformations-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Defining-new-deformations" title="Permalink"></a></h2><p>We can also define new types of deformation that are more specialized. We need only define a subtype of <code>AbstractDeformationMotion</code> and extend the function <code>deformation_velocity</code> to work with it. The signature of this function is <code>deformation_velocity(body,deformation,time)</code>.</p><p>For example, let&#39;s define a motion on a rectangular shape that will deform only the top side in the normal direction, but leave the rest of the surface stationary. We will use the <code>side</code> field of the <code>Polygon</code> shape type to access the top, and set its vertical velocity.</p><pre><code class="language-julia hljs">struct TopMotion{UT} &lt;: AbstractDeformationMotion
    vtop :: UT
end

function RigidBodyTools.deformation_velocity(body::Polygon,def::TopMotion,t::Real)

    u, v = zero(body.x̃end), zero(body.ỹend)
    top = body.side[3]
    v[top] .= def.vtop.(body.x̃end[top],body.ỹend[top],t)
    return vcat(u,v)
end</code></pre><p>Now apply it</p><pre><code class="language-julia hljs">Xp_to_jp = MotionTransform(0.0,0.0,0.0)
Xc_to_jc = MotionTransform(0.0,0.0,0.0)
dofs = [ConstantVelocityDOF(0.0)]
joint = Joint(RevoluteJoint,0,Xp_to_jp,1,Xc_to_jc,dofs)

body = Rectangle(1.0,2.0,0.02)
vfcn(x,y,t) = 0.2*(1-x^2)*cos(t)
def = TopMotion(vfcn)

ls = RigidBodyMotion(joint,body,def)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1 linked system(s) of bodies
   1 bodies
   1 joints
</code></pre><p>Let&#39;s try it out</p><pre><code class="language-julia hljs">@animate_motion body ls π/100 4π (-1.5,1.5) (-2.5,2.5)</code></pre><img src="f4d9085c.gif" alt="Example block output"/><p>As desired, the top surface deforms vertically, but the rest of the surface is stationary.</p><h2 id="Deformation-functions"><a class="docs-heading-anchor" href="#Deformation-functions">Deformation functions</a><a id="Deformation-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Deformation-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RigidBodyTools.DeformationMotion" href="#RigidBodyTools.DeformationMotion"><code>RigidBodyTools.DeformationMotion</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DeformationMotion(u::Function,v::Function)</code></pre><p>Create an instance of directly-specified velocity whose components are specified with functions. These functions <code>u</code> and <code>v</code> must each be of the form <code>f(x̃,ỹ,t)</code>, where <code>x̃</code> and <code>ỹ</code> are coordinates of a point in the body coordinate system and <code>t</code> is time, and they must return the corresponding velocity component in the body coordinate system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/RigidBodyTools.jl/blob/2cd410846608eed9b94300cd1611d7679c8876a7/src/directmotions.jl#L58-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RigidBodyTools.ConstantDeformationMotion" href="#RigidBodyTools.ConstantDeformationMotion"><code>RigidBodyTools.ConstantDeformationMotion</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ConstantDeformationMotion(u::Vector{Float64},v::Vector{Float64})</code></pre><p>Create an instance of basic directly-specified (constant) velocity, to be associated with a body whose length is the same as <code>u</code> and <code>v</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/RigidBodyTools.jl/blob/2cd410846608eed9b94300cd1611d7679c8876a7/src/directmotions.jl#L35-L41">source</a></section></article><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../exogenous/">« Exogenous degrees of freedom</a><a class="docs-footer-nextpage" href="../surfacevelocities/">Evaluating velocities on body surfaces »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Thursday 17 April 2025 05:13">Thursday 17 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
